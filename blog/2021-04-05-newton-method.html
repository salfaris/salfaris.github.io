<!DOCTYPE html>

<html lang="en">
<head>
<!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="https://salfaris.me/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
<link href="https://salfaris.me/theme/css/style.css" rel="stylesheet" type="text/css"/>
<link href="https://salfaris.me/theme/css/pygments.css" rel="stylesheet" type="text/css"/>
<link href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono" rel="stylesheet" type="text/css"/>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="Salman Faris" name="author"/>
<meta content="A place where I rant mostly about math, machine learning and python." name="description"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@salmannfaris" name="twitter:site"/>
<meta content="@salmannfaris" name="twitter:creator"/>
<link href="https://salfaris.me/feeds/all.atom.xml" rel="alternate" title="Salman Faris Atom" type="application/atom+xml"/>
<meta content="numerical-analysis, algorithms" name="keywords"/>
<meta content="Root-hunting algorithm: Newton's method" property="twitter:title"/>
<meta content="https://salfaris.me/blog/images/newton-method.png" property="twitter:image"/>
<title>Salman Faris – Root-hunting algorithm: Newton's method</title>
<link href="https://salfaris.me/blog/2021-04-05-newton-method.html" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Salman Faris", "item": "https://salfaris.me"}, {"@type": "ListItem", "position": 2, "name": "Blog", "item": "https://salfaris.me/blog"}, {"@type": "ListItem", "position": 3, "name": "2021 04 05 newton method", "item": "https://salfaris.me/blog/2021-04-05-newton-method.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Salman Faris"}, "publisher": {"@type": "Organization", "name": "Salman Faris"}, "headline": "Root-hunting algorithm: Newton's method", "about": "math", "datePublished": "2021-04-05 19:23", "image": "newton-method.png"}</script></head>
<body>
<aside>
<div id="user_meta">
<a href="https://salfaris.me">
<img alt="logo" src="https://salfaris.me/images/avatar_circ.png"/>
</a>
<h2><a href="https://salfaris.me">Salman Faris</a></h2>
<p>I talk about math, machine learning and python.</p>
<ul>
<li><a href="/blog">blog</a></li>
<li><a href="/pages/about">about</a></li>
<li><a href="/pages/resources">resources</a></li>
</ul>
</div>
</aside>
<main>
<header>
<p>
<a href="https://salfaris.me">Index</a> ¦
          <a href="https://salfaris.me/archives.html">Archives</a>  ¦
          <a href="https://salfaris.me/feeds/all.atom.xml">Atom</a> </p>
</header>
<article>
<div class="article_title">
<h1><a href="https://salfaris.me/blog/2021-04-05-newton-method.html">Root-hunting algorithm: Newton's method</a></h1>
</div>
<div class="article_meta">
<p>Posted on: Mon 05 April 2021</p>
</div>
<!-- -->
<div class="article_text"><p><strong>Problem:</strong> Given a real-valued function <span class="math">\(f(x)\)</span> in one real variable, what are the values <span class="math">\(x_0 \in \mathbb{R}\)</span> such that <span class="math">\(f(x_0) = 0\)</span>?</p>
<p>If the function <span class="math">\(f(x)\)</span> is linear, then the problem is trivial. Explicitly, if <span class="math">\(f(x) = ax + b\)</span> for some <span class="math">\(a, b \in \mathbb{R}\)</span>, then <span class="math">\(x_0 = -b/a\)</span> gives a solution as long as <span class="math">\(a \neq 0\)</span>. However, when the function is nonlinear, the problem can get complicated very fast. For example, try solving when the function is <span class="math">\(f(x) = \sin(e^{x}) + \cos(\log x)\)</span>.</p>
<hr/>
<h3>Newton's idea (an overview)</h3>
<p>One way of solving this problem is to <em>linearize</em> the function <span class="math">\(f(x)\)</span> around a certain point <span class="math">\(x_0\)</span> of our choice so that we can easily solve the resulting linear equation. Say we get <span class="math">\(x_1\)</span> as a solution, then we repeat linearizing <span class="math">\(f(x)\)</span> around <span class="math">\(x_1\)</span>; so on and so forth. The initial point <span class="math">\(x_0\)</span> is chosen such that it is close to our hoped solution, say, <span class="math">\(x^*\)</span>. The idea is that if <span class="math">\(x_0\)</span> is suitably chosen, then the solutions <span class="math">\(x_1, x_2, x_3, \ldots\)</span> to each linear approximation of <span class="math">\(f(x)\)</span> approximates <span class="math">\(x^*\)</span> better and better, and in the limit converges to <span class="math">\(x^*\)</span>. This whole process is known as the <strong>Newton's method</strong>. Here is a nice picture of the method applied to <span class="math">\(f(x) = x^2\)</span> over <span class="math">\(n = 10\)</span> iterations, starting at <span class="math">\(x_0 = 1\)</span>.</p>
<p><img alt="Newton's method illustration" src="https://salfaris.me/blog/images/newton-method.png"/></p>
<p>We see from the illustration that the Newton's method converges towards <span class="math">\(x^* = 0\)</span>, as expected. For the code to generate this plot, see end of post.</p>
<hr/>
<h3>Newton's idea (the algebra)</h3>
<p>Let us make our discussion above more precise. Linearizing <span class="math">\(f(x)\)</span> around <span class="math">\(x_0\)</span> simply means Taylor expanding <span class="math">\(f\)</span> around <span class="math">\(x_0\)</span> and neglecting <span class="math">\(\mathcal{O}(h^2)\)</span> terms. Of course, this is assuming that we can actually do Taylor expansion in the first place! Explicitly, the Taylor expansion of <span class="math">\(f\)</span> around <span class="math">\(x_0\)</span> yields</p>
<div class="math">$$f(x) = f(x_0) + f'(x_0) (x - x_0) + \mathcal{O}(h^2). $$</div>
<p>So if we neglect <span class="math">\(\mathcal{O}(h^2)\)</span> terms, we get (in approximation) the linear equation</p>
<div class="math">$$f(x) = f(x_0) + f'(x_0) (x - x_0).$$</div>
<p>The solution to this linear equation is thus simply</p>
<div class="math">$$x_1 = x_0 - \frac{f(x_0)}{f'(x_0)}.$$</div>
<p>We then repeat the process by linearizing <span class="math">\(f\)</span> around <span class="math">\(x_1\)</span>. In this case we have</p>
<div class="math">$$f(x) = f(x_1) + f'(x_1) (x - x_1) \implies x_2 = x_1 - \frac{f(x_1)}{f'(x_1)}, $$</div>
<p>with <span class="math">\(x_2\)</span> being a solution. Doing this iteratively yields a general formula</p>
<div class="math">$$x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)},$$</div>
<p>known as <strong>Newton's formula</strong>. Here is the Newton's method in one statement.</p>
<hr/>
<p><strong>Theorem</strong> (Newton's method). Let <span class="math">\(x^* \in \mathbb{R}\)</span> be a solution to <span class="math">\(f(x) = 0\)</span>. If <span class="math">\(x_n\)</span> is an approximation of <span class="math">\(x^*\)</span> and <span class="math">\(f'(x_n) \neq 0\)</span>, then the next approximation to <span class="math">\(x^*\)</span> is given by
</p>
<div class="math">$$x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)},$$</div>
<p>
with initial condition, a suitably chosen <span class="math">\(x_0 \in \mathbb{R}\)</span>.</p>
<hr/>
<h3>Code implementation</h3>
<p>An iterative implementation of the Newton's method in Python is given below:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">iterative_newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">"""Solves f(x) = 0 using the Newton's method.</span>

<span class="sd">    Args:</span>
<span class="sd">        f: A callable, the function f(x) of interest.</span>
<span class="sd">        df: A callable, the derivative of f(x).</span>
<span class="sd">        x0: Initial good point to start linearizing.</span>
<span class="sd">        n (Optional): Number of recursion steps to make.</span>
<span class="sd">    """</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">]</span> <span class="c1"># Sequence of xn.</span>

    <span class="c1"># Get latest x value in sequence and</span>
    <span class="c1"># apply the Newton recurrence formula.</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">last</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">last</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">last</span><span class="p">)</span>
        <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">xs</span>
</code></pre></div>
<p>Using the same parameters as above, we can also implement a one-liner recursive implementation:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">recursive_newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x0</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">recursive_newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>Observe that both algorithms have <span class="math">\(\mathcal{O}(n)\)</span> space complexity where <span class="math">\(n\)</span> is the number of iterations or depth of the recursion. The time complexity for the iterative implementation is also <span class="math">\(\mathcal{O}(n)\)</span>, but for the recursive implementation, it is a bit tricky to compute (so we leave it as an exercise!).</p>
<p>Note that there is a small caveat to the Newton's method which we have implicitly highlight in this post, can you spot it?</p>
<p><strong>Code to generate Newton's method plot</strong></p>
<p>We will utilize the <code>numpy</code> and <code>matplotlib</code> packages.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</code></pre></div>
<p>We first need two helper functions.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">""" Returns the derivative of f(x) based on the</span>
<span class="sd">    finite difference approximation.</span>
<span class="sd">    """</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">tangent_line</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">""" Generates the tangent line to f(x) at x0 over</span>
<span class="sd">    the interval [a, b].</span>
<span class="sd">    """</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
    <span class="n">ytan</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">df</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">ytan</span>
</code></pre></div>
<p>We then define the function <span class="math">\(f(x) = x^2\)</span>, compute its derivative and apply Newton's method over <span class="math">\(n = 10\)</span> iterations, starting at <span class="math">\(x_0 = 1\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">iterative_newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>  <span class="c1"># To utilize numpy broadcasting later.</span>
</code></pre></div>
<p>We finally plot the function.</p>
<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'bmh'</span><span class="p">)</span>

<span class="c1"># Bounds on the x-axis.</span>
<span class="n">lo</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
<span class="n">hi</span> <span class="o">=</span> <span class="mf">1.1</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">lo</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Points of the function f(x).</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>

<span class="c1"># Tangent lines to f(x) at the approximations.</span>
<span class="n">xtan0</span><span class="p">,</span> <span class="n">ytan0</span> <span class="o">=</span> <span class="n">tangent_line</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.35</span><span class="o">*</span><span class="n">mesh</span><span class="p">,</span> <span class="n">hi</span><span class="p">)</span>
<span class="n">xtan1</span><span class="p">,</span> <span class="n">ytan1</span> <span class="o">=</span> <span class="n">tangent_line</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">mesh</span><span class="p">,</span> <span class="n">hi</span><span class="p">)</span>
<span class="n">xtan2</span><span class="p">,</span> <span class="n">ytan2</span> <span class="o">=</span> <span class="n">tangent_line</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">lo</span><span class="p">,</span> <span class="mf">0.7</span><span class="o">*</span><span class="n">mesh</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"$f(x) = x^2$"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtan0</span><span class="p">,</span> <span class="n">ytan0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Linearization 1"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtan1</span><span class="p">,</span> <span class="n">ytan1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Linearization 2"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtan2</span><span class="p">,</span> <span class="n">ytan2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Linearization 3"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'darkmagenta'</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">"Newton's method</span><span class="se">\n</span><span class="s2">approximations"</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'None'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># Labels for occurring approximations.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'+'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
              <span class="n">linestyles</span><span class="o">=</span><span class="s1">'dotted'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">"$x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">$"</span><span class="p">,</span>
                 <span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                 <span class="n">textcoords</span><span class="o">=</span><span class="s2">"offset points"</span><span class="p">,</span>
                 <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">),</span>
                 <span class="n">ha</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Grid and xy-axis.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>

<span class="c1"># Labels and legend.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"x"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"y"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Newton's method applied to $f(x) = x^2$"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script></div>
<div class="article_meta">
<p>
      Category:
      <a href="https://salfaris.me/category/math.html">math</a>
 – Tags:       <a href="https://salfaris.me/tag/numerical-analysis.html">numerical-analysis</a>,       <a href="https://salfaris.me/tag/algorithms.html">algorithms</a> </p>
</div>
<div id="article_comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
      var disqus_identifier = "blog/2021-04-05-newton-method.html";
      (function () {
        var dsq = document.createElement("script");
        dsq.type = "text/javascript";
        dsq.async = true;
        dsq.src = "//salfaris.disqus.com/embed.js";
        (
          document.getElementsByTagName("head")[0] ||
          document.getElementsByTagName("body")[0]
        ).appendChild(dsq);
      })();
    </script>
</div>
</article>
<div id="ending_message">
<p>
          © Salman Faris. Built using
          <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by
          Giulio Fidente on
          <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>.         </p>
</div>
</main>
</body>
</html>
<!-- This script solves the issue of mathjax not rendering on homepage -->
<script async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script>